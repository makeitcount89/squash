<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>BabylonJS Cube Scene with Screenshot</title>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <style>
        canvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <canvas id="renderCanvas"></canvas>
    <button id="takescreenshot">Create Screenshot</button>
    <a id="downloadLink" style="display: none" download="screenshot.png">Download Screenshot</a>

    <script type="text/javascript">
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
        var createScene = function () {
            var scene = new BABYLON.Scene(engine);

            // Create cube
            var cube = BABYLON.MeshBuilder.CreateBox("cube", { size: 2 });
            cube.position = new BABYLON.Vector3(0, 1, 0);

            // Create camera
            var camera = new BABYLON.ArcRotateCamera("ArcRotateCamera", 1, 0.8, 20, new BABYLON.Vector3(0, 0, 0), scene);
            camera.attachControl(canvas, true);

            // Create light
            var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(1, 0.5, 0), scene);

            return scene;
        };

        var scene = createScene();
        var ssButton = document.getElementById("takescreenshot");
        var downloadLink = document.getElementById("downloadLink");

        if (ssButton == null) {
            ssButton = document.createElement("button");
            document.body.appendChild(ssButton);
        }

        ssButton.id = "takescreenshot";
        ssButton.textContent = "Create Screenshot";

        ssButton.onclick = function () {
            BABYLON.Tools.CreateScreenshot(engine, scene.activeCamera, { width: 1024, height: 300 },
                function (data) {
                    var img = document.createElement("img");
                    img.src = data;
                    document.body.appendChild(img);

                    // Show download link
                    downloadLink.href = data;
                    downloadLink.style.display = "block";
                });
        };

        engine.runRenderLoop(function () {
            scene.render();
        });
    </script>
</body>

</html>
