<!DOCTYPE html>
<html>
<head>
    <title>Guitar Tuner</title>
</head>
<body>
    <h1>Guitatue</h1>
    <p>Click the "Start Tuner" button, play a string on your guitar, and it will display the detected pitch.</p>

    <button id="startTuner">Start Tuner</button>
    <div id="tunerDisplay">Waiting for input...</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.7/Tone.min.js"></script>
    <script>
        let tuner;
        let tunerDisplay = document.getElementById("tunerDisplay");

        document.getElementById("startTuner").addEventListener("click", () => {
            if (!tuner) {
                tuner = new Tone.FrequencyAnalyzer({
                    size: 2048, // Buffer size
                    type: "fft",
                });

                Tone.UserMedia.open()
                    .then((mic) => {
                        mic.connect(tuner);
                        tuner.toDestination();
                        tunerInput();
                    })
                    .catch((error) => {
                        console.error("Error accessing microphone:", error);
                    });
            }
        });

        function tunerInput() {
            if (tuner && tuner.isInitialized) {
                const note = tuner.getFrequency();
                if (note) {
                    const closestNote = Tone.Frequency(note).toNote();
                    tunerDisplay.textContent = `Detected Note: ${closestNote}`;
                }
                requestAnimationFrame(tunerInput);
            }
        }
    </script>
</body>
</html>
