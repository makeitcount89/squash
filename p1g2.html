<!DOCTYPE html>
<html>
<head>
    <title>Guitar Tuner</title>
    <script src="path/to/pitch.js"></script>
</head>
<body>
    <h1>Gtune</h1>

    <div id="tuner">
        <button id="start-btn">Start Tuning</button>
        <div id="tuner-display">Tune your guitar here.</div>
    </div>

    <script>
        let audioContext = null;
        let analyser = null;
        const bufferLength = 2048;
        const dataArray = new Uint8Array(bufferLength);
        const pitchDetection = new PitchDetection({
            sampleRate: 44100, // Set your sample rate
            bufferSize: bufferLength,
        });

        document.getElementById('start-btn').addEventListener('click', () => {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
                    const microphone = audioContext.createMediaStreamSource(stream);
                    microphone.connect(analyser);
                }).catch((error) => {
                    console.error('Error accessing the microphone:', error);
                });
            }

            function updatePitch() {
                analyser.getByteTimeDomainData(dataArray);
                const pitchValue = pitchDetection.getPitch(dataArray);

                if (pitchValue) {
                    document.getElementById('tuner-display').textContent = `Detected pitch: ${pitchValue.toFixed(2)} Hz`;
                } else {
                    document.getElementById('tuner-display').textContent = 'No pitch detected.';
                }

                requestAnimationFrame(updatePitch);
            }

            // Start pitch detection
            updatePitch();
        });
    </script>
</body>
</html>
